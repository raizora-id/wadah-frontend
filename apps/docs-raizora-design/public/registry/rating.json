{
  "$schema": "https://ui.shadcn.com/schema/registry.json",
  "homepage": "https://www.kibo-ui.com/rating",
  "name": "rating",
  "type": "registry:ui",
  "author": "Hayden Bleasel <hello@haydenbleasel.com>",
  "registryDependencies": [],
  "dependencies": [
    "@radix-ui/react-use-controllable-state",
    "lucide-react"
  ],
  "devDependencies": [],
  "files": [
    {
      "type": "registry:ui",
      "path": "index.tsx",
      "content": "'use client';\n\nimport { cn } from '@/lib/utils';\nimport { useControllableState } from '@radix-ui/react-use-controllable-state';\nimport { type LucideProps, StarIcon } from 'lucide-react';\nimport {\n  Children,\n  cloneElement,\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport type { KeyboardEvent, MouseEvent, ReactElement, ReactNode } from 'react';\n\ntype RatingContextValue = {\n  value: number;\n  readOnly: boolean;\n  hoverValue: number | null;\n  focusedStar: number | null;\n  handleValueChange: (\n    event: MouseEvent<HTMLButtonElement> | KeyboardEvent<HTMLButtonElement>,\n    value: number\n  ) => void;\n  handleKeyDown: (event: KeyboardEvent<HTMLButtonElement>) => void;\n  setHoverValue: (value: number | null) => void;\n  setFocusedStar: (value: number | null) => void;\n};\n\nconst RatingContext = createContext<RatingContextValue | null>(null);\n\nconst useRating = () => {\n  const context = useContext(RatingContext);\n  if (!context) {\n    throw new Error('useRating must be used within a Rating component');\n  }\n  return context;\n};\n\nexport type RatingButtonProps = LucideProps & {\n  index?: number;\n  icon?: ReactElement<LucideProps>;\n};\n\nexport const RatingButton = ({\n  index: providedIndex,\n  size = 20,\n  className,\n  icon = <StarIcon />,\n}: RatingButtonProps) => {\n  const {\n    value,\n    readOnly,\n    hoverValue,\n    focusedStar,\n    handleValueChange,\n    handleKeyDown,\n    setHoverValue,\n    setFocusedStar,\n  } = useRating();\n\n  const index = providedIndex ?? 0;\n  const isActive = index < (hoverValue ?? focusedStar ?? value ?? 0);\n  let tabIndex = -1;\n\n  if (!readOnly) {\n    tabIndex = value === index + 1 ? 0 : -1;\n  }\n\n  return (\n    <button\n      type=\"button\"\n      onClick={(event) => handleValueChange(event, index + 1)}\n      onMouseEnter={() => !readOnly && setHoverValue(index + 1)}\n      onKeyDown={handleKeyDown}\n      onFocus={() => setFocusedStar(index + 1)}\n      onBlur={() => setFocusedStar(null)}\n      disabled={readOnly}\n      className={cn(\n        'rounded-full focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',\n        'p-0.5',\n        readOnly && 'cursor-default',\n        className\n      )}\n      tabIndex={tabIndex}\n    >\n      {cloneElement(icon, {\n        size,\n        className: cn(\n          'transition-colors duration-200',\n          isActive && 'fill-current',\n          !readOnly && 'cursor-pointer'\n        ),\n        'aria-hidden': 'true',\n      })}\n    </button>\n  );\n};\n\nexport type RatingProps = {\n  defaultValue?: number;\n  value?: number;\n  onChange?: (\n    event: MouseEvent<HTMLButtonElement> | KeyboardEvent<HTMLButtonElement>,\n    value: number\n  ) => void;\n  onValueChange?: (value: number) => void;\n  readOnly?: boolean;\n  className?: string;\n  children?: ReactNode;\n};\n\nexport const Rating = ({\n  value: controlledValue,\n  onValueChange: controlledOnValueChange,\n  defaultValue,\n  onChange,\n  readOnly = false,\n  className,\n  children,\n  ...props\n}: RatingProps) => {\n  const [hoverValue, setHoverValue] = useState<number | null>(null);\n  const [focusedStar, setFocusedStar] = useState<number | null>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [value, onValueChange] = useControllableState({\n    defaultProp: defaultValue,\n    prop: controlledValue,\n    onChange: controlledOnValueChange,\n  });\n\n  const handleValueChange = useCallback(\n    (\n      event: MouseEvent<HTMLButtonElement> | KeyboardEvent<HTMLButtonElement>,\n      newValue: number\n    ) => {\n      if (!readOnly) {\n        onChange?.(event, newValue);\n        onValueChange?.(newValue);\n      }\n    },\n    [readOnly, onChange, onValueChange]\n  );\n\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent<HTMLButtonElement>) => {\n      if (readOnly) {\n        return;\n      }\n\n      const total = Children.count(children);\n      let newValue = focusedStar !== null ? focusedStar : (value ?? 0);\n\n      switch (event.key) {\n        case 'ArrowRight':\n          if (event.shiftKey || event.metaKey) {\n            newValue = total;\n          } else {\n            newValue = Math.min(total, newValue + 1);\n          }\n          break;\n        case 'ArrowLeft':\n          if (event.shiftKey || event.metaKey) {\n            newValue = 1;\n          } else {\n            newValue = Math.max(1, newValue - 1);\n          }\n          break;\n        default:\n          return;\n      }\n\n      event.preventDefault();\n      setFocusedStar(newValue);\n      handleValueChange(event, newValue);\n    },\n    [focusedStar, value, children, readOnly, handleValueChange]\n  );\n\n  useEffect(() => {\n    if (focusedStar !== null && containerRef.current) {\n      const buttons = containerRef.current.querySelectorAll('button');\n      buttons[focusedStar - 1]?.focus();\n    }\n  }, [focusedStar]);\n\n  const contextValue: RatingContextValue = {\n    value: value ?? 0,\n    readOnly,\n    hoverValue,\n    focusedStar,\n    handleValueChange,\n    handleKeyDown,\n    setHoverValue,\n    setFocusedStar,\n  };\n\n  return (\n    <RatingContext.Provider value={contextValue}>\n      <div\n        ref={containerRef}\n        className={cn('inline-flex items-center gap-0.5', className)}\n        role=\"radiogroup\"\n        aria-label=\"Rating\"\n        onMouseLeave={() => setHoverValue(null)}\n        {...props}\n      >\n        {Children.map(children, (child, index) => {\n          if (!child) {\n            return null;\n          }\n\n          return cloneElement(child as ReactElement<RatingButtonProps>, {\n            index,\n          });\n        })}\n      </div>\n    </RatingContext.Provider>\n  );\n};\n",
      "target": "components/ui/kibo-ui/rating/index.tsx"
    }
  ]
}